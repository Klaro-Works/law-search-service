# RAG ì‹œìŠ¤í…œ ì„œë¹„ìŠ¤ ë¶„ë¦¬ ì„¤ê³„

## ğŸ“‹ ê²°ë¡  (TL;DR)

**âœ… ê¶Œì¥: ì„œë¹„ìŠ¤ ë¶„ë¦¬**
- **Document Pipeline Service**: ë¬¸ì„œ ì²˜ë¦¬ ì „ë‹´
- **RAG Chatbot Service**: ì±—ë´‡ ì‘ë‹µ ì „ë‹´
- **ê³µìœ  ë¦¬ì†ŒìŠ¤**: Qdrant, MinIO, PostgreSQL

---

## ğŸ¯ ë¶„ë¦¬ ì´ìœ 

### 1. ì±…ì„ ë¶„ë¦¬ (SRP)
```
ğŸ“„ Data Pipeline Service
â”œâ”€ MinIO ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë‹
â”œâ”€ ë¬¸ì„œ íŒŒì‹± (PDF, DOCX, etc.)
â”œâ”€ ì „ì²˜ë¦¬ (ì²­í‚¹, ë©”íƒ€ë°ì´í„° ì¶”ì¶œ)
â”œâ”€ ì„ë² ë”© ìƒì„±
â””â”€ Qdrant ì ì¬

ğŸ¤– RAG Chatbot Service
â”œâ”€ ì‚¬ìš©ì ì¿¼ë¦¬ ì²˜ë¦¬
â”œâ”€ Qdrant ê²€ìƒ‰
â”œâ”€ LLM ìƒì„± (Agno Agent)
â””â”€ ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ
```

### 2. í™•ì¥ì„±
- **íŒŒì´í”„ë¼ì¸**: CPU ì§‘ì•½ì  â†’ ë³„ë„ ìŠ¤ì¼€ì¼ë§
- **ì±—ë´‡**: ë©”ëª¨ë¦¬/ë„¤íŠ¸ì›Œí¬ ì§‘ì•½ì  â†’ ë…ë¦½ ìŠ¤ì¼€ì¼ë§
- K8s HPAë¡œ ê°ê° auto-scaling ê°€ëŠ¥

### 3. ê¸°ìˆ  ìŠ¤íƒ ë…ë¦½ì„±
```python
# Document Pipeline
- Celery (ë°°ì¹˜ ì›Œí¬í”Œë¡œ)
- PyPDF2, python-docx (íŒŒì‹±)
- sentence-transformers (ì„ë² ë”©)
- MinIO SDK

# RAG Chatbot
- Agno (Agent í”„ë ˆì„ì›Œí¬)
- FastAPI (ë¹„ë™ê¸° API)
- OpenAI/Anthropic (LLM)
- WebSocket (ìŠ¤íŠ¸ë¦¬ë°)
```

### 4. ì¥ì•  ê²©ë¦¬
- íŒŒì´í”„ë¼ì¸ ê³¼ë¶€í•˜ â†’ ì±—ë´‡ì€ ì •ìƒ ì‘ë™
- LLM API ì¥ì•  â†’ íŒŒì´í”„ë¼ì¸ì€ ê³„ì† ì²˜ë¦¬

---

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Frontend (Admin UI)                 â”‚
â”‚  - ë¬¸ì„œ ì—…ë¡œë“œ UI                                        â”‚
â”‚  - ì±—ë´‡ ì„¤ì • UI                                          â”‚
â”‚  - ëŒ€í™” UI                                               â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                        â”‚
      â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Document Pipeline    â”‚  â”‚  RAG Chatbot Service            â”‚
â”‚ Service              â”‚  â”‚  (ê¸°ì¡´ MVP)                     â”‚
â”‚                      â”‚  â”‚                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ MinIO Listener  â”‚ â”‚  â”‚  â”‚  Agno Agent              â”‚  â”‚
â”‚ â”‚ (S3 Event)      â”‚ â”‚  â”‚  â”‚  - retrieve_documents    â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”‚  - generate_answer       â”‚  â”‚
â”‚          â”‚          â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚          â–¼          â”‚  â”‚         â”‚                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚         â–¼                      â”‚
â”‚ â”‚ Document        â”‚ â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Processor       â”‚ â”‚  â”‚  â”‚  Chat API                â”‚  â”‚
â”‚ â”‚ - Parse         â”‚ â”‚  â”‚  â”‚  (FastAPI)               â”‚  â”‚
â”‚ â”‚ - Chunk         â”‚ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ â”‚ - Embed         â”‚ â”‚  â”‚                                 â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚                                 â”‚
â”‚          â”‚          â”‚  â”‚                                 â”‚
â”‚          â–¼          â”‚  â”‚                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚                                 â”‚
â”‚ â”‚ Qdrant Client   â”‚ â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ (Write)         â”‚ â”‚  â”‚  â”‚  Retriever               â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”‚  (Read from Qdrant)      â”‚  â”‚
â”‚          â”‚          â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                            â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚        Shared Resources              â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚  Qdrant (Vector DB)                 â”‚
     â”‚  - Collections (by doc_store_id)    â”‚
     â”‚  - Read/Write separated             â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚  MinIO (Object Storage)             â”‚
     â”‚  - Buckets (by tenant)              â”‚
     â”‚  - S3 Event Notifications           â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚  PostgreSQL (Metadata)              â”‚
     â”‚  - Document metadata                â”‚
     â”‚  - Chatbot configs                  â”‚
     â”‚  - Processing status                â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‚ ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
ai-platform/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ document-pipeline/          # ìƒˆë¡œ ì¶”ê°€
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ listeners/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ minio_listener.py
â”‚   â”‚   â”‚   â”œâ”€â”€ processors/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ pdf_processor.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ docx_processor.py
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ chunker.py
â”‚   â”‚   â”‚   â”œâ”€â”€ embedders/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ sentence_transformer.py
â”‚   â”‚   â”‚   â”œâ”€â”€ loaders/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ qdrant_loader.py
â”‚   â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ routes/
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ upload.py
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ status.py
â”‚   â”‚   â”‚   â””â”€â”€ main.py
â”‚   â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”‚   â””â”€â”€ Dockerfile
â”‚   â”‚
â”‚   â””â”€â”€ rag-chatbot/                # ê¸°ì¡´ MVP
â”‚       â”œâ”€â”€ rag-chatbot-mvp/
â”‚       â”‚   â”œâ”€â”€ agents/
â”‚       â”‚   â”œâ”€â”€ api/
â”‚       â”‚   â”œâ”€â”€ core/
â”‚       â”‚   â””â”€â”€ retrieval/
â”‚       â””â”€â”€ requirements.txt
â”‚
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ src/
â”‚       â””â”€â”€ pages/
â”‚           â”œâ”€â”€ document-pipeline/  # ë¬¸ì„œ ê´€ë¦¬ UI
â”‚           â””â”€â”€ rag-chatbot/        # ì±—ë´‡ UI
â”‚
â””â”€â”€ k8s/
    â”œâ”€â”€ document-pipeline/
    â”‚   â”œâ”€â”€ deployment.yaml
    â”‚   â””â”€â”€ service.yaml
    â””â”€â”€ rag-chatbot/
        â”œâ”€â”€ deployment.yaml
        â””â”€â”€ service.yaml
```

---

## ğŸ”„ ë°ì´í„° íë¦„

### **1. ë¬¸ì„œ ì—…ë¡œë“œ â†’ ì ì¬**

```
1. [ì‚¬ìš©ì] ë¬¸ì„œ ì—…ë¡œë“œ
   â†’ Frontend â†’ MinIO Bucket

2. [MinIO] S3 Event Notification ë°œí–‰
   â†’ "s3:ObjectCreated:*"

3. [Document Pipeline] ì´ë²¤íŠ¸ ìˆ˜ì‹ 
   â†’ minio_listener.py

4. [Pipeline] ë¬¸ì„œ ì²˜ë¦¬
   â”œâ”€ MinIOì—ì„œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ
   â”œâ”€ PDF íŒŒì‹± (PyPDF2)
   â”œâ”€ í˜ì´ì§€ë³„ ì²­í‚¹
   â”œâ”€ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ (ì œëª©, ë‚ ì§œ, etc.)
   â””â”€ ì„ë² ë”© ìƒì„± (sentence-transformers)

5. [Pipeline] Qdrant ì ì¬
   â””â”€ collection = f"{tenant_id}_{doc_store_id}"

6. [Pipeline] PostgreSQL ë©”íƒ€ë°ì´í„° ì €ì¥
   â””â”€ ë¬¸ì„œ ID, ìƒíƒœ, í˜ì´ì§€ ìˆ˜, ì²˜ë¦¬ ì‹œê°„

7. (ì„ íƒ) [Pipeline] Kafka ì´ë²¤íŠ¸ ë°œí–‰
   â†’ "DocumentProcessed"
   â†’ Chatbot Serviceê°€ ì¸ë±ìŠ¤ ê°±ì‹  ì•Œë¦¼ ë°›ìŒ
```

### **2. ì‚¬ìš©ì ì§ˆë¬¸ â†’ ë‹µë³€**

```
1. [ì‚¬ìš©ì] ì§ˆë¬¸ ì…ë ¥
   â†’ Frontend â†’ RAG Chatbot API

2. [Chatbot] Agent ì‹¤í–‰
   â””â”€ agent.arun(query, user_id, metadata)

3. [Chatbot] retrieve_documents Tool í˜¸ì¶œ
   â”œâ”€ Qdrant ê²€ìƒ‰ (collection = doc_store_id)
   â”œâ”€ ì „ëµ: lexical, vector, hybrid, mmr
   â””â”€ Top-K ë¬¸ì„œ ë°˜í™˜

4. [Chatbot] LLM ìƒì„±
   â”œâ”€ í”„ë¡¬í”„íŠ¸ ì¡°ë¦½ (context + query)
   â””â”€ OpenAI API í˜¸ì¶œ

5. [Chatbot] ì‘ë‹µ ë°˜í™˜
   â””â”€ Frontend (WebSocket or HTTP)
```

---

## ğŸ”— ì„œë¹„ìŠ¤ ê°„ í†µì‹ 

### **Option 1: ì´ë²¤íŠ¸ ê¸°ë°˜ (ì¶”ì²œ)**

```python
# Document Pipeline (Producer)
from kafka import KafkaProducer

producer = KafkaProducer(bootstrap_servers='kafka:9092')

# ë¬¸ì„œ ì²˜ë¦¬ ì™„ë£Œ í›„
event = {
    "event_type": "DocumentProcessed",
    "tenant_id": "tenant1",
    "doc_store_id": "manual_docs",
    "document_id": "doc123",
    "pages": 42,
    "timestamp": "2025-12-16T11:00:00Z"
}
producer.send('document-events', value=json.dumps(event).encode())
```

```python
# RAG Chatbot (Consumer, Optional)
from kafka import KafkaConsumer

consumer = KafkaConsumer(
    'document-events',
    bootstrap_servers='kafka:9092',
    group_id='chatbot-service'
)

for message in consumer:
    event = json.loads(message.value)
    if event['event_type'] == 'DocumentProcessed':
        # ìºì‹œ ë¬´íš¨í™” ë˜ëŠ” ì¸ë±ìŠ¤ ê°±ì‹  ì•Œë¦¼
        logger.info(f"New document processed: {event['document_id']}")
```

### **Option 2: ê³µìœ  ë°ì´í„°ë² ì´ìŠ¤**

```python
# PostgreSQL Schema
CREATE TABLE document_metadata (
    id UUID PRIMARY KEY,
    tenant_id VARCHAR(255),
    doc_store_id VARCHAR(255),
    status VARCHAR(50),  -- 'processing', 'completed', 'failed'
    pages INTEGER,
    created_at TIMESTAMP,
    updated_at TIMESTAMP
);

# Pipeline: Write
# Chatbot: Read (ë¬¸ì„œ ìƒíƒœ í™•ì¸ìš©)
```

### **Option 3: REST API (í•„ìš” ì‹œ)**

```python
# Document Pipeline API
@app.get("/api/v1/documents/{doc_id}/status")
async def get_document_status(doc_id: str):
    return {"status": "completed", "pages": 42}

# Chatbotì—ì„œ í˜¸ì¶œ (ì„ íƒì )
status = httpx.get(f"{PIPELINE_URL}/api/v1/documents/{doc_id}/status")
```

---

## âš™ï¸ MinIO ì„¤ì •

```python
# Document Pipeline - MinIO Listener
from minio import Minio
from minio.notificationconfig import QueueConfig

minio_client = Minio(
    "minio:9000",
    access_key="admin",
    secret_key="password",
    secure=False
)

# S3 Event Notification ì„¤ì •
config = QueueConfig(
    queue_arn='arn:minio:sqs::document-queue:webhook',
    events=['s3:ObjectCreated:*'],
    prefix_filter_rule='documents/',
)
minio_client.set_bucket_notification(bucket_name, config)

# ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
events = minio_client.listen_bucket_notification(bucket_name)
for event in events:
    for record in event['Records']:
        object_key = record['s3']['object']['key']
        process_document(object_key)
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### **1. ë¬¸ì„œ ì—…ë¡œë“œ â†’ ê²€ìƒ‰**

```python
# Step 1: ë¬¸ì„œ ì—…ë¡œë“œ
POST /api/v1/documents/upload
Files: { "file": "manual.pdf" }
Headers: { "X-Tenant-Id": "tenant1" }

# Step 2: íŒŒì´í”„ë¼ì¸ ì²˜ë¦¬ ëŒ€ê¸°
GET /api/v1/documents/{doc_id}/status
Response: { "status": "processing" }

# Step 3: ì²˜ë¦¬ ì™„ë£Œ í™•ì¸
GET /api/v1/documents/{doc_id}/status
Response: { "status": "completed", "pages": 42 }

# Step 4: ì±—ë´‡ì—ì„œ ê²€ìƒ‰
POST /api/v1/chat/my-chatbot
Body: { "query": "ì—…ë¬´ ë§¤ë‰´ì–¼ ì ˆì°¨ëŠ”?" }
Response: { "response": "...", "sources": [...] }
```

---

## ğŸ“Š ë¹„êµ: ë¶„ë¦¬ vs í†µí•©

| í•­ëª© | ë¶„ë¦¬ (ì¶”ì²œ) | í†µí•© |
|------|------------|------|
| **í™•ì¥ì„±** | âœ… ë…ë¦½ ìŠ¤ì¼€ì¼ë§ | âŒ í•¨ê»˜ ìŠ¤ì¼€ì¼ë§ |
| **ì¥ì•  ê²©ë¦¬** | âœ… ì˜í–¥ ìµœì†Œí™” | âŒ ì „ì²´ ì˜í–¥ |
| **ë°°í¬ ë…ë¦½ì„±** | âœ… ë…ë¦½ ë°°í¬ | âŒ í•¨ê»˜ ë°°í¬ |
| **ê¸°ìˆ  ì„ íƒ** | âœ… ììœ ë¡œì›€ | âŒ ì œì•½ |
| **ë³µì¡ë„** | ğŸŸ¡ ì¤‘ê°„ (í†µì‹  ì¶”ê°€) | âœ… ë‚®ìŒ |
| **ì´ˆê¸° ê°œë°œ** | ğŸŸ¡ ì¡°ê¸ˆ ëŠë¦¼ | âœ… ë¹ ë¦„ |
| **ìš´ì˜ ë¹„ìš©** | ğŸŸ¡ ì»¨í…Œì´ë„ˆ 2ê°œ | âœ… ì»¨í…Œì´ë„ˆ 1ê°œ |

---

## ğŸš€ êµ¬í˜„ ë¡œë“œë§µ

### **Phase 1: Document Pipeline ê°œë°œ (1ì£¼)**
- [ ] MinIO Listener êµ¬í˜„
- [ ] PDF/DOCX íŒŒì„œ êµ¬í˜„
- [ ] ì²­í‚¹ ë¡œì§ êµ¬í˜„
- [ ] ì„ë² ë”© ìƒì„± (sentence-transformers)
- [ ] Qdrant ì ì¬ ë¡œì§

### **Phase 2: í†µí•© (1ì£¼)**
- [ ] PostgreSQL ë©”íƒ€ë°ì´í„° ìŠ¤í‚¤ë§ˆ
- [ ] ë¬¸ì„œ ìƒíƒœ API (ì—…ë¡œë“œ/ìƒíƒœ ì¡°íšŒ)
- [ ] Kafka ì´ë²¤íŠ¸ ë°œí–‰ (ì„ íƒ)
- [ ] Frontend ë¬¸ì„œ ê´€ë¦¬ UI

### **Phase 3: ë°°í¬ ë° í…ŒìŠ¤íŠ¸ (1ì£¼)**
- [ ] Docker ì´ë¯¸ì§€ ë¹Œë“œ
- [ ] K8s Deployment ì‘ì„±
- [ ] End-to-End í…ŒìŠ¤íŠ¸
- [ ] ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ (ëŒ€ëŸ‰ ë¬¸ì„œ ì²˜ë¦¬)

---

## ğŸ’¡ ì¶”ê°€ ê³ ë ¤ì‚¬í•­

### **1. Qdrant Collection ì „ëµ**

```python
# Option A: í…Œë„ŒíŠ¸ë³„ Collection (ê²©ë¦¬ ê°•í•¨)
collection_name = f"{tenant_id}_{doc_store_id}"
# ì˜ˆ: "tenant1_manual_docs"

# Option B: ë‹¨ì¼ Collection + Metadata í•„í„° (ìœ ì—°)
collection_name = "documents"
metadata_filter = {
    "tenant_id": tenant_id,
    "doc_store_id": doc_store_id
}
```

### **2. ì„ë² ë”© ëª¨ë¸ ì„ íƒ**

```python
# í•œêµ­ì–´ ì§€ì› ëª¨ë¸
from sentence_transformers import SentenceTransformer

# Option 1: ë‹¤êµ­ì–´ ëª¨ë¸
model = SentenceTransformer('paraphrase-multilingual-MiniLM-L12-v2')

# Option 2: OpenAI ì„ë² ë”© (Integration Hub ê²½ìœ )
import openai
embedding = openai.Embedding.create(
    model="text-embedding-3-small",
    input=text
)
```

### **3. ì²­í‚¹ ì „ëµ**

```python
# í˜ì´ì§€ ê¸°ë°˜ ì²­í‚¹ (í˜„ì¬ ì‚¬ìš©)
chunks = [{"page": i, "content": page_text} for i, page_text in enumerate(pages)]

# í† í° ê¸°ë°˜ ì²­í‚¹ (ê³ ê¸‰)
from langchain.text_splitter import RecursiveCharacterTextSplitter

splitter = RecursiveCharacterTextSplitter(
    chunk_size=512,
    chunk_overlap=50,
    separators=["\n\n", "\n", ". ", " "]
)
chunks = splitter.create_documents([full_text])
```

---

## âœ… ê²°ë¡ 

**ì„œë¹„ìŠ¤ ë¶„ë¦¬ë¥¼ ê°•ë ¥íˆ ê¶Œì¥í•©ë‹ˆë‹¤.**

### **í•µì‹¬ ì´ìœ :**
1. âœ… í™•ì¥ì„±: ê° ì„œë¹„ìŠ¤ ë…ë¦½ ìŠ¤ì¼€ì¼ë§
2. âœ… ì¥ì•  ê²©ë¦¬: í•œìª½ ë¬¸ì œê°€ ë‹¤ë¥¸ ìª½ì— ì˜í–¥ ì—†ìŒ
3. âœ… ê¸°ìˆ  ë…ë¦½ì„±: ìµœì  ê¸°ìˆ  ìŠ¤íƒ ì„ íƒ ê°€ëŠ¥
4. âœ… ë°°í¬ ë…ë¦½ì„±: ë¹ ë¥¸ ë°˜ë³µ ê°œë°œ ê°€ëŠ¥

### **í†µí•©ì„ ê³ ë ¤í•˜ëŠ” ê²½ìš°:**
- ì´ˆê¸° MVP ë‹¨ê³„ (2ì£¼ ë‚´ í”„ë¡œí† íƒ€ì…)
- ë§¤ìš° ì‘ì€ ê·œëª¨ (<50 ì‚¬ìš©ì, <100 ë¬¸ì„œ/ì¼)
- ë‹¨ì¼ ê°œë°œì
- ë¹ ë¥¸ ê²€ì¦ í•„ìš”

**í•˜ì§€ë§Œ ì¥ê¸°ì ìœ¼ë¡œëŠ” ë¶„ë¦¬ê°€ í•„ìˆ˜ì…ë‹ˆë‹¤.**
